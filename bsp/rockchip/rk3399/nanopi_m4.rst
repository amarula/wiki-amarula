RK3399 NanoPi M4
###################

Hardware Access
***************
This board uses baudrate of 1500000

.. image:: /images/nanopi_m4.jpg

BSP
***

Manual
=======

Arm Trusted Firware
-------------------

::

   $ git clone https://github.com/ARM-software/arm-trusted-firmware.git
   $ make CROSS_COMPILE=aarch64-linux-gnu- PLAT=rk3399 bl31

U-Boot
-------

::

   $ git clone https://gitlab.denx.de/u-boot/u-boot.git
   $ cd u-boot
   $ cp /path/to arm-trusted-firmware /build/rk3399/release/bl31/bl31.elf  ./
   $ make nanopi-m4-rk3399_defconfig 


   $ make -j4

   CHK     include/config/uboot.release
   CHK     include/config.h
   CFG     u-boot.cfg
   CHK     include/generated/version_autogenerated.h
   CHK     include/generated/timestamp_autogenerated.h
   UPD     include/generated/timestamp_autogenerated.h
   HOSTCC  scripts/basic/fixdep
   CC      lib/asm-offsets.s
   CHK     include/generated/generic-asm-offsets.h
   CC      arch/arm/lib/asm-offsets.s
   CHK     include/generated/asm-offsets.h
   HOSTCC  scripts/dtc/dtc.o
   HOSTCC  scripts/dtc/flattree.o
   HOSTCC  scripts/dtc/fstree.o
   HOSTCC  scripts/dtc/data.o
   HOSTCC  scripts/dtc/livetree.o
   HOSTCC  scripts/dtc/treesource.o
   HOSTCC  scripts/dtc/srcpos.o
   HOSTCC  scripts/dtc/checks.o
   HOSTCC  scripts/dtc/util.o
   LEX     scripts/dtc/dtc-lexer.lex.c
   YACC    scripts/dtc/dtc-parser.tab.h
   HOSTCC  scripts/dtc/dtc-lexer.lex.o
   YACC    scripts/dtc/dtc-parser.tab.c
   HOSTCC  scripts/dtc/dtc-parser.tab.o
   HOSTLD  scripts/dtc/dtc
   HOSTCC  tools/gen_eth_addr
   HOSTCC  tools/gen_ethaddr_crc.o
   WRAP    tools/lib/crc8.c
   HOSTCC  tools/lib/crc8.o
   HOSTLD  tools/gen_ethaddr_crc
   HOSTCC  tools/img2srec
   HOSTCC  tools/mkenvimage.o
   HOSTCC  tools/os_support.o
   WRAP    tools/lib/crc32.c
   HOSTCC  tools/lib/crc32.o
   HOSTLD  tools/mkenvimage
   HOSTCC  tools/aisimage.o
   HOSTCC  tools/atmelimage.o
   WRAP    tools/common/bootm.c
   HOSTCC  tools/common/bootm.o
   HOSTCC  tools/default_image.o
   WRAP    tools/lib/fdtdec_common.c
   HOSTCC  tools/lib/fdtdec_common.o
   WRAP    tools/lib/fdtdec.c
   HOSTCC  tools/lib/fdtdec.o
   HOSTCC  tools/fit_common.o
   HOSTCC  tools/fit_image.o
   WRAP    tools/common/image-fit.c
   HOSTCC  tools/common/image-fit.o
   HOSTCC  tools/image-host.o
   WRAP    tools/common/image.c
   HOSTCC  tools/common/image.o
   HOSTCC  tools/imagetool.o
   HOSTCC  tools/imximage.o
   HOSTCC  tools/imx8image.o
   HOSTCC  tools/imx8mimage.o
   HOSTCC  tools/kwbimage.o
   WRAP    tools/lib/md5.c
   HOSTCC  tools/lib/md5.o
   HOSTCC  tools/lpc32xximage.o
   HOSTCC  tools/mxsimage.o
   HOSTCC  tools/omapimage.o
   HOSTCC  tools/pblimage.o
   HOSTCC  tools/pbl_crc32.o
   HOSTCC  tools/vybridimage.o
   HOSTCC  tools/stm32image.o
   WRAP    tools/lib/rc4.c
   HOSTCC  tools/lib/rc4.o
   HOSTCC  tools/rkcommon.o
   HOSTCC  tools/rkimage.o
   HOSTCC  tools/rksd.o
   HOSTCC  tools/rkspi.o
   HOSTCC  tools/socfpgaimage.o
   WRAP    tools/lib/crc16.c
   HOSTCC  tools/lib/crc16.o
   WRAP    tools/lib/sha1.c
   HOSTCC  tools/lib/sha1.o
   WRAP    tools/lib/sha256.c
   HOSTCC  tools/lib/sha256.o
   WRAP    tools/common/hash.c
   HOSTCC  tools/common/hash.o
   HOSTCC  tools/ublimage.o
   HOSTCC  tools/zynqimage.o
   HOSTCC  tools/zynqmpimage.o
   HOSTCC  tools/zynqmpbif.o
   HOSTCC  tools/libfdt/fdt.o
   HOSTCC  tools/libfdt/fdt_wip.o
   HOSTCC  tools/libfdt/fdt_sw.o
   HOSTCC  tools/libfdt/fdt_rw.o
   HOSTCC  tools/libfdt/fdt_strerror.o
   HOSTCC  tools/libfdt/fdt_empty_tree.o
   HOSTCC  tools/libfdt/fdt_addresses.o
   HOSTCC  tools/libfdt/fdt_overlay.o
   WRAP    tools/lib/libfdt/fdt_ro.c
   HOSTCC  tools/lib/libfdt/fdt_ro.o
   WRAP    tools/lib/libfdt/fdt_region.c
   HOSTCC  tools/lib/libfdt/fdt_region.o
   HOSTCC  tools/gpimage.o
   HOSTCC  tools/gpimage-common.o
   HOSTCC  tools/mtk_image.o
   HOSTCC  tools/dumpimage.o
   HOSTLD  tools/dumpimage
   HOSTCC  tools/mkimage.o
   HOSTLD  tools/mkimage
   HOSTCC  tools/proftool
   HOSTCC  tools/relocate-rela
   HOSTCC  tools/fdtgrep.o
   HOSTLD  tools/fdtgrep
   LD      arch/arm/cpu/built-in.o
   CC      arch/arm/cpu/armv8/cpu.o
   CC      arch/arm/cpu/armv8/generic_timer.o
   CC      arch/arm/cpu/armv8/cache_v8.o
   AS      arch/arm/cpu/armv8/exceptions.o
   CC      arch/arm/cpu/armv8/exception_level.o
   AS      arch/arm/cpu/armv8/cache.o
   AS      arch/arm/cpu/armv8/tlb.o
   AS      arch/arm/cpu/armv8/transition.o
   CC      arch/arm/cpu/armv8/fwcall.o
   CC      arch/arm/cpu/armv8/cpu-dt.o
   AS      arch/arm/cpu/armv8/smccc-call.o
   LD      arch/arm/cpu/armv8/built-in.o
   AS      arch/arm/cpu/armv8/start.o
   AS      arch/arm/lib/crt0_64.o
   AS      arch/arm/lib/setjmp_aarch64.o
   AS      arch/arm/lib/relocate_64.o
   CC      arch/arm/lib/bootm-fdt.o
   CC      arch/arm/lib/bootm.o
   CC      arch/arm/lib/image.o
   CC      arch/arm/lib/zimage.o
   CC      arch/arm/lib/sections.o
   CC      arch/arm/lib/stack.o
   CC      arch/arm/lib/interrupts_64.o
   CC      arch/arm/lib/cache.o
   CC      arch/arm/lib/psci-dt.o
   LD      arch/arm/lib/built-in.o
   AR      arch/arm/lib/lib.a
   AS      arch/arm/lib/crt0_aarch64_efi.o
   CC      arch/arm/lib/reloc_aarch64_efi.o
   CC      arch/arm/mach-rockchip/rk3399/clk_rk3399.o
   CC      arch/arm/mach-rockchip/rk3399/rk3399.o
   CC      arch/arm/mach-rockchip/rk3399/syscon_rk3399.o
   LD      arch/arm/mach-rockchip/rk3399/built-in.o
   CC      arch/arm/mach-rockchip/boot_mode.o
   CC      arch/arm/mach-rockchip/rk3399-board.o
   CC      arch/arm/mach-rockchip/sdram_common.o
   LD      arch/arm/mach-rockchip/built-in.o
   CC      board/rockchip/evb_rk3399/evb-rk3399.o
   LD      board/rockchip/evb_rk3399/built-in.o
   CC      cmd/boot.o
   CC      cmd/bootm.o
   CC      cmd/help.o
   CC      cmd/version.o
   CC      cmd/blk_common.o
   CC      cmd/source.o
   CC      cmd/bdinfo.o
   CC      cmd/blkcache.o
   CC      cmd/bootefi.o
   CC      cmd/bootz.o
   CC      cmd/booti.o
   CC      cmd/console.o
   CC      cmd/dm.o
   CC      cmd/echo.o
   CC      cmd/elf.o
   CC      cmd/exit.o
   CC      cmd/ext4.o
   CC      cmd/ext2.o
   CC      cmd/fat.o
   CC      cmd/fdt.o
   CC      cmd/flash.o
   CC      cmd/fs.o
   CC      cmd/itest.o
   CC      cmd/load.o
   CC      cmd/mem.o
   CC      cmd/mii.o
   CC      cmd/mdio.o
   CC      cmd/misc.o
   CC      cmd/mmc.o
   CC      cmd/net.o
   CC      cmd/nvedit_efi.o
   CC      cmd/part.o
   CC      cmd/pinmux.o
   CC      cmd/pxe.o
   CC      cmd/sf.o
   CC      cmd/time.o
   CC      cmd/test.o
   CC      cmd/unzip.o
   CC      cmd/lzmadec.o
   CC      cmd/usb.o
   CC      cmd/disk.o
   CC      cmd/ximg.o
   CC      cmd/gpt.o
   CC      cmd/nvedit.o
   LD      cmd/built-in.o
   CC      common/init/board_init.o
   LD      common/init/built-in.o
   CC      common/main.o
   CC      common/exports.o
   CC      common/hash.o
   CC      common/cli_hush.o
   CC      common/autoboot.o
   CC      common/board_f.o
   CC      common/board_r.o
   CC      common/board_info.o
   CC      common/bootm.o
   CC      common/bootm_os.o
   CC      common/fdt_support.o
   CC      common/miiphyutil.o
   CC      common/usb.o
   CC      common/usb_hub.o
   CC      common/usb_storage.o
   CC      common/splash.o
   CC      common/menu.o
   CC      common/cli_readline.o
   CC      common/cli_simple.o
   CC      common/bouncebuf.o
   CC      common/console.o
   CC      common/dlmalloc.o
   CC      common/malloc_simple.o
   CC      common/image.o
   CC      common/image-fdt.o
   CC      common/image-fit.o
   CC      common/memsize.o
   CC      common/stdio.o
   CC      common/cli.o
   CC      common/command.o
   CC      common/s_record.o
   CC      common/xyzModem.o
   LD      common/built-in.o
   CC      disk/part.o
   CC      disk/part_dos.o
   CC      disk/part_iso.o
   CC      disk/part_efi.o
   LD      disk/built-in.o
   CC      drivers/adc/adc-uclass.o
   CC      drivers/adc/rockchip-saradc.o
   LD      drivers/adc/built-in.o
   LD      drivers/ata/built-in.o
   LD      drivers/axi/built-in.o
   CC      drivers/block/blk-uclass.o
   CC      drivers/block/blkcache.o
   LD      drivers/block/built-in.o
   LD      drivers/board/built-in.o
   LD      drivers/clk/imx/built-in.o
   CC      drivers/clk/rockchip/clk_rk3399.o
   LD      drivers/clk/rockchip/built-in.o
   LD      drivers/clk/tegra/built-in.o
   CC      drivers/clk/clk-uclass.o
   CC      drivers/clk/clk_fixed_rate.o
   CC      drivers/clk/clk_fixed_factor.o
   LD      drivers/clk/built-in.o
   CC      drivers/core/device.o
   CC      drivers/core/fdtaddr.o
   CC      drivers/core/lists.o
   CC      drivers/core/root.o
   CC      drivers/core/uclass.o
   CC      drivers/core/util.o
   CC      drivers/core/device-remove.o
   CC      drivers/core/simple-bus.o
   CC      drivers/core/dump.o
   CC      drivers/core/regmap.o
   CC      drivers/core/syscon-uclass.o
   CC      drivers/core/of_extra.o
   CC      drivers/core/ofnode.o
   CC      drivers/core/read_extra.o
   LD      drivers/core/built-in.o
   CC      drivers/crypto/fsl/sec.o
   LD      drivers/crypto/fsl/built-in.o
   LD      drivers/crypto/rsa_mod_exp/built-in.o
   LD      drivers/crypto/built-in.o
   LD      drivers/dfu/built-in.o
   CC      drivers/firmware/firmware-uclass.o
   CC      drivers/firmware/psci.o
   LD      drivers/firmware/built-in.o
   CC      drivers/input/input.o
   CC      drivers/input/key_matrix.o
   LD      drivers/input/built-in.o
   LD      drivers/mailbox/built-in.o
   LD      drivers/memory/built-in.o
   LD      drivers/misc/built-in.o
   CC      drivers/mmc/mmc.o
   CC      drivers/mmc/mmc-uclass.o
   CC      drivers/mmc/mmc_write.o
   CC      drivers/mmc/dw_mmc.o
   CC      drivers/mmc/rockchip_dw_mmc.o
   CC      drivers/mmc/sdhci.o
   CC      drivers/mmc/rockchip_sdhci.o
   LD      drivers/mmc/built-in.o
   LD      drivers/pcmcia/built-in.o
   LD      drivers/phy/allwinner/built-in.o
   LD      drivers/phy/marvell/built-in.o
   LD      drivers/pinctrl/broadcom/built-in.o
   LD      drivers/pinctrl/nxp/built-in.o
   CC      drivers/pinctrl/rockchip/pinctrl-rockchip-core.o
   CC      drivers/pinctrl/rockchip/pinctrl-rk3399.o
   LD      drivers/pinctrl/rockchip/built-in.o
   CC      drivers/pinctrl/pinctrl-uclass.o
   CC      drivers/pinctrl/pinctrl-generic.o
   LD      drivers/pinctrl/built-in.o
   CC      drivers/pwm/pwm-uclass.o
   CC      drivers/pwm/rk_pwm.o
   LD      drivers/pwm/built-in.o
   CC      drivers/ram/rockchip/sdram_rk3399.o
   LD      drivers/ram/rockchip/built-in.o
   CC      drivers/ram/ram-uclass.o
   LD      drivers/ram/built-in.o
   LD      drivers/reset/built-in.o
   CC      drivers/rtc/date.o
   CC      drivers/rtc/rtc-lib.o
   LD      drivers/rtc/built-in.o
   LD      drivers/scsi/built-in.o
   LD      drivers/smem/built-in.o
   LD      drivers/soc/built-in.o
   LD      drivers/sound/built-in.o
   LD      drivers/spmi/built-in.o
   CC      drivers/sysreset/sysreset-uclass.o
   CC      drivers/sysreset/sysreset_rockchip.o
   LD      drivers/sysreset/built-in.o
   LD      drivers/thermal/built-in.o
   LD      drivers/video/bridge/built-in.o
   LD      drivers/video/sunxi/built-in.o
   LD      drivers/video/built-in.o
   LD      drivers/watchdog/built-in.o
   LD      drivers/built-in.o
   LD      drivers/dma/built-in.o
   CC      drivers/gpio/gpio-uclass.o
   CC      drivers/gpio/rk_gpio.o
   LD      drivers/gpio/built-in.o
   CC      drivers/i2c/i2c-uclass.o
   CC      drivers/i2c/rk_i2c.o
   LD      drivers/i2c/built-in.o
   LD      drivers/mtd/nand/built-in.o
   CC      drivers/mtd/mtdcore.o
   CC      drivers/mtd/mtd_uboot.o
   LD      drivers/mtd/built-in.o
   LD      drivers/mtd/onenand/built-in.o
   CC      drivers/mtd/spi/sf-uclass.o
   LD      drivers/mtd/spi/built-in.o
   LD      drivers/net/mscc_eswitch/built-in.o
   LD      drivers/net/ti/built-in.o
   CC      drivers/net/designware.o
   CC      drivers/net/gmac_rockchip.o
   LD      drivers/net/built-in.o
   CC      drivers/net/phy/phy.o
   LD      drivers/net/phy/built-in.o
   LD      drivers/power/built-in.o
   LD      drivers/power/battery/built-in.o
   LD      drivers/power/domain/built-in.o
   LD      drivers/power/fuel_gauge/built-in.o
   LD      drivers/power/mfd/built-in.o
   CC      drivers/power/pmic/pmic-uclass.o
   CC      drivers/power/pmic/rk8xx.o
   LD      drivers/power/pmic/built-in.o
   CC      drivers/power/regulator/regulator-uclass.o
   CC      drivers/power/regulator/pwm_regulator.o
   CC      drivers/power/regulator/fixed.o
   CC      drivers/power/regulator/rk8xx.o
   LD      drivers/power/regulator/built-in.o
   CC      drivers/serial/serial-uclass.o
   CC      drivers/serial/ns16550.o
   LD      drivers/serial/built-in.o
   CC      drivers/spi/spi-uclass.o
   LD      drivers/spi/built-in.o
   CC      drivers/usb/common/common.o
   LD      drivers/usb/common/built-in.o
   LD      drivers/usb/dwc3/built-in.o
   LD      drivers/usb/emul/built-in.o
   CC      drivers/usb/eth/usb_ether.o
   CC      drivers/usb/eth/asix.o
   CC      drivers/usb/eth/asix88179.o
   CC      drivers/usb/eth/mcs7830.o
   CC      drivers/usb/eth/smsc95xx.o
   CC      drivers/usb/eth/r8152.o
   CC      drivers/usb/eth/r8152_fw.o
   LD      drivers/usb/eth/built-in.o
   CC      drivers/usb/host/usb-uclass.o
   CC      drivers/usb/host/ehci-hcd.o
   CC      drivers/usb/host/ehci-generic.o
   CC      drivers/usb/host/xhci.o
   CC      drivers/usb/host/xhci-mem.o
   CC      drivers/usb/host/xhci-ring.o
   CC      drivers/usb/host/xhci-dwc3.o
   CC      drivers/usb/host/xhci-rockchip.o
   LD      drivers/usb/host/built-in.o
   LD      drivers/usb/musb-new/built-in.o
   LD      drivers/usb/musb/built-in.o
   LD      drivers/usb/phy/built-in.o
   LD      drivers/usb/ulpi/built-in.o
   CC      env/common.o
   CC      env/env.o
   CC      env/attr.o
   CC      env/callback.o
   CC      env/flags.o
   CC      env/mmc.o
   LD      env/built-in.o
   CC      fs/ext4/ext4fs.o
   CC      fs/ext4/ext4_common.o
   CC      fs/ext4/dev.o
   LD      fs/ext4/built-in.o
   CC      fs/fat/fat_write.o
   LD      fs/fat/built-in.o
   CC      fs/fs.o
   CC      fs/fs_internal.o
   LD      fs/built-in.o
   CC      lib/efi_driver/efi_uclass.o
   CC      lib/efi_driver/efi_block_device.o
   LD      lib/efi_driver/built-in.o
   CC      lib/efi_loader/efi_bootmgr.o
   CC      lib/efi_loader/efi_boottime.o
   CC      lib/efi_loader/efi_console.o
   CC      lib/efi_loader/efi_device_path.o
   CC      lib/efi_loader/efi_device_path_to_text.o
   CC      lib/efi_loader/efi_device_path_utilities.o
   CC      lib/efi_loader/efi_file.o
   CC      lib/efi_loader/efi_hii.o
   CC      lib/efi_loader/efi_hii_config.o
   CC      lib/efi_loader/efi_image_loader.o
   CC      lib/efi_loader/efi_memory.o
   CC      lib/efi_loader/efi_root_node.o
   CC      lib/efi_loader/efi_runtime.o
   CC      lib/efi_loader/efi_setup.o
   CC      lib/efi_loader/efi_unicode_collation.o
   CC      lib/efi_loader/efi_variable.o
   CC      lib/efi_loader/efi_watchdog.o
   CC      lib/efi_loader/efi_disk.o
   CC      lib/efi_loader/efi_net.o
   CC      lib/efi_loader/efi_smbios.o
   LD      lib/efi_loader/built-in.o
   CC      lib/efi_loader/helloworld.o
   AS      lib/efi_loader/efi_crt0.o
   CC      lib/efi_loader/efi_reloc.o
   CC      lib/efi_loader/efi_freestanding.o
   LD      lib/efi_loader/helloworld_efi.so
   OBJCOPY lib/efi_loader/helloworld.efi
   CC      lib/libfdt/fdt.o
   CC      lib/libfdt/fdt_wip.o
   CC      lib/libfdt/fdt_strerror.o
   CC      lib/libfdt/fdt_sw.o
   CC      lib/libfdt/fdt_rw.o
   CC      lib/libfdt/fdt_empty_tree.o
   CC      lib/libfdt/fdt_addresses.o
   CC      lib/libfdt/fdt_ro.o
   CC      lib/libfdt/fdt_region.o
   LD      lib/libfdt/built-in.o
   CC      lib/lzma/LzmaDec.o
   CC      lib/lzma/LzmaTools.o
   LD      lib/lzma/built-in.o
   CC      lib/zlib/zlib.o
   LD      lib/zlib/built-in.o
   CC      lib/charset.o
   CC      lib/crc7.o
   CC      lib/crc8.o
   CC      lib/crc16.o
   CC      lib/errno_str.o
   CC      lib/fdtdec_common.o
   CC      lib/smbios.o
   CC      lib/ldiv.o
   CC      lib/md5.o
   CC      lib/net_utils.o
   CC      lib/rc4.o
   CC      lib/list_sort.o
   CC      lib/sha1.o
   CC      lib/sha256.o
   CC      lib/gunzip.o
   CC      lib/fdtdec.o
   CC      lib/qsort.o
   CC      lib/hashtable.o
   CC      lib/errno.o
   CC      lib/display_options.o
   CC      lib/crc32.o
   CC      lib/ctype.o
   CC      lib/div64.o
   CC      lib/hang.o
   CC      lib/linux_compat.o
   CC      lib/linux_string.o
   CC      lib/lmb.o
   CC      lib/membuff.o
   CC      lib/slre.o
   CC      lib/string.o
   CC      lib/tables_csum.o
   CC      lib/time.o
   CC      lib/hexdump.o
   CC      lib/uuid.o
   CC      lib/rand.o
   CC      lib/panic.o
   CC      lib/vsprintf.o
   CC      lib/strto.o
   CC      lib/strmhz.o
   LD      lib/built-in.o
   CC      net/checksum.o
   CC      net/arp.o
   CC      net/bootp.o
   CC      net/eth-uclass.o
   CC      net/eth_common.o
   CC      net/net.o
   CC      net/nfs.o
   CC      net/ping.o
   CC      net/tftp.o
   LD      net/built-in.o
   CC      examples/standalone/hello_world.o
   CC      examples/standalone/stubs.o
   LD      examples/standalone/libstubs.o
   LD      examples/standalone/hello_world
   OBJCOPY examples/standalone/hello_world.srec
   OBJCOPY examples/standalone/hello_world.bin
   LDS     u-boot.lds
   LD      u-boot
   OBJCOPY u-boot.srec
   OBJCOPY u-boot-nodtb.bin
   start=$(aarch64-linux-gnu-nm u-boot | grep __rel_dyn_start | cut -f 1 -d ' '); end=$(aarch64-linux-gnu-nm u-boot | grep __rel_dyn_end | cut -f 1 -d ' '); tools/relocate-rela u-boot-nodtb.bin 0x00200000 $start $end
   DTC     arch/arm/dts/rk3036-sdk.dtb
   DTC     arch/arm/dts/rk3128-evb.dtb
   DTC     arch/arm/dts/rk3188-radxarock.dtb
   DTC     arch/arm/dts/rk3229-evb.dtb
   DTC     arch/arm/dts/rk3288-evb.dtb
   DTC     arch/arm/dts/rk3288-fennec.dtb
   DTC     arch/arm/dts/rk3288-firefly.dtb
   DTC     arch/arm/dts/rk3288-miqi.dtb
   DTC     arch/arm/dts/rk3288-phycore-rdk.dtb
   DTC     arch/arm/dts/rk3288-popmetal.dtb
   DTC     arch/arm/dts/rk3288-rock2-square.dtb
   DTC     arch/arm/dts/rk3288-tinker.dtb
   DTC     arch/arm/dts/rk3288-veyron-jerry.dtb
   DTC     arch/arm/dts/rk3288-veyron-mickey.dtb
   DTC     arch/arm/dts/rk3288-veyron-minnie.dtb
   DTC     arch/arm/dts/rk3288-veyron-speedy.dtb
   DTC     arch/arm/dts/rk3288-vyasa.dtb
   DTC     arch/arm/dts/rk3328-evb.dtb
   DTC     arch/arm/dts/rk3399-ficus.dtb
   DTC     arch/arm/dts/rk3368-lion.dtb
   DTC     arch/arm/dts/rk3368-sheep.dtb
   DTC     arch/arm/dts/rk3368-geekbox.dtb
   DTC     arch/arm/dts/rk3368-px5-evb.dtb
   DTC     arch/arm/dts/rk3399-evb.dtb
   DTC     arch/arm/dts/rk3399-firefly.dtb
   DTC     arch/arm/dts/rk3399-gru-bob.dtb
   DTC     arch/arm/dts/rk3399-nanopc-t4.dtb
   DTC     arch/arm/dts/rk3399-nanopi-m4.dtb
   DTC     arch/arm/dts/rk3399-nanopi-neo4.dtb
   DTC     arch/arm/dts/rk3399-orangepi.dtb
   DTC     arch/arm/dts/rk3399-puma-ddr1333.dtb
   DTC     arch/arm/dts/rk3399-puma-ddr1600.dtb
   DTC     arch/arm/dts/rk3399-puma-ddr1866.dtb
   DTC     arch/arm/dts/rk3399-rock960.dtb
   DTC     arch/arm/dts/rk3399-rockpro64.dtb
   DTC     arch/arm/dts/rv1108-elgin-r1.dtb
   DTC     arch/arm/dts/rv1108-evb.dtb
   SHIPPED dts/dt.dtb
   FDTGREP dts/dt-spl.dtb
   CAT     u-boot-dtb.bin
   COPY    u-boot.bin
   SYM     u-boot.sym
   CC      spl/arch/arm/mach-rockchip/rk3399/clk_rk3399.o
   CC      spl/arch/arm/mach-rockchip/rk3399/rk3399.o
   CC      spl/arch/arm/mach-rockchip/rk3399/syscon_rk3399.o
   LD      spl/arch/arm/mach-rockchip/rk3399/built-in.o
   CC      spl/arch/arm/mach-rockchip/sdram_common.o
   CC      spl/arch/arm/mach-rockchip/bootrom.o
   CC      spl/arch/arm/mach-rockchip/rk3399-board-spl.o
   CC      spl/arch/arm/mach-rockchip/spl-boot-order.o
   LD      spl/arch/arm/mach-rockchip/built-in.o
   CC      spl/arch/arm/cpu/armv8/cpu.o
   CC      spl/arch/arm/cpu/armv8/generic_timer.o
   CC      spl/arch/arm/cpu/armv8/cache_v8.o
   AS      spl/arch/arm/cpu/armv8/cache.o
   AS      spl/arch/arm/cpu/armv8/tlb.o
   AS      spl/arch/arm/cpu/armv8/transition.o
   CC      spl/arch/arm/cpu/armv8/fwcall.o
   CC      spl/arch/arm/cpu/armv8/cpu-dt.o
   AS      spl/arch/arm/cpu/armv8/smccc-call.o
   LD      spl/arch/arm/cpu/armv8/built-in.o
   AS      spl/arch/arm/cpu/armv8/start.o
   LD      spl/arch/arm/cpu/built-in.o
   AS      spl/arch/arm/lib/crt0_64.o
   AS      spl/arch/arm/lib/setjmp_aarch64.o
   CC      spl/arch/arm/lib/spl.o
   CC      spl/arch/arm/lib/zimage.o
   CC      spl/arch/arm/lib/bootm-fdt.o
   CC      spl/arch/arm/lib/sections.o
   CC      spl/arch/arm/lib/stack.o
   CC      spl/arch/arm/lib/interrupts_64.o
   CC      spl/arch/arm/lib/cache.o
   CC      spl/arch/arm/lib/psci-dt.o
   LD      spl/arch/arm/lib/built-in.o
   AR      spl/arch/arm/lib/lib.a
   AS      spl/arch/arm/lib/crt0_aarch64_efi.o
   CC      spl/arch/arm/lib/reloc_aarch64_efi.o
   CC      spl/board/rockchip/evb_rk3399/evb-rk3399.o
   LD      spl/board/rockchip/evb_rk3399/built-in.o
   CC      spl/common/spl/spl.o
   CC      spl/common/spl/spl_fit.o
   CC      spl/common/spl/spl_mmc.o
   CC      spl/common/spl/spl_atf.o
   LD      spl/common/spl/built-in.o
   CC      spl/common/init/board_init.o
   LD      spl/common/init/built-in.o
   CC      spl/common/common_fit.o
   CC      spl/common/fdt_support.o
   CC      spl/common/bouncebuf.o
   CC      spl/common/console.o
   CC      spl/common/dlmalloc.o
   CC      spl/common/malloc_simple.o
   CC      spl/common/image.o
   CC      spl/common/image-fdt.o
   CC      spl/common/image-fit.o
   CC      spl/common/memsize.o
   CC      spl/common/stdio.o
   CC      spl/common/cli.o
   CC      spl/common/command.o
   CC      spl/common/s_record.o
   CC      spl/common/xyzModem.o
   LD      spl/common/built-in.o
   CC      spl/cmd/nvedit.o
   LD      spl/cmd/built-in.o
   CC      spl/env/common.o
   CC      spl/env/env.o
   LD      spl/env/built-in.o
   CC      spl/lib/libfdt/fdt.o
   CC      spl/lib/libfdt/fdt_wip.o
   CC      spl/lib/libfdt/fdt_strerror.o
   CC      spl/lib/libfdt/fdt_sw.o
   CC      spl/lib/libfdt/fdt_rw.o
   CC      spl/lib/libfdt/fdt_empty_tree.o
   CC      spl/lib/libfdt/fdt_addresses.o
   CC      spl/lib/libfdt/fdt_ro.o
   CC      spl/lib/libfdt/fdt_region.o
   LD      spl/lib/libfdt/built-in.o
   CC      spl/lib/sha1.o
   CC      spl/lib/sha256.o
   CC      spl/lib/fdtdec_common.o
   CC      spl/lib/fdtdec.o
   CC      spl/lib/qsort.o
   CC      spl/lib/hashtable.o
   CC      spl/lib/errno.o
   CC      spl/lib/display_options.o
   CC      spl/lib/crc32.o
   CC      spl/lib/ctype.o
   CC      spl/lib/div64.o
   CC      spl/lib/hang.o
   CC      spl/lib/linux_compat.o
   CC      spl/lib/linux_string.o
   CC      spl/lib/lmb.o
   CC      spl/lib/membuff.o
   CC      spl/lib/slre.o
   CC      spl/lib/string.o
   CC      spl/lib/tables_csum.o
   CC      spl/lib/time.o
   CC      spl/lib/hexdump.o
   CC      spl/lib/uuid.o
   CC      spl/lib/rand.o
   CC      spl/lib/panic.o
   CC      spl/lib/tiny-printf.o
   CC      spl/lib/strto.o
   LD      spl/lib/built-in.o
   CC      spl/disk/part.o
   CC      spl/disk/part_dos.o
   CC      spl/disk/part_efi.o
   LD      spl/disk/built-in.o
   CC      spl/drivers/block/blk-uclass.o
   LD      spl/drivers/block/built-in.o
   LD      spl/drivers/clk/imx/built-in.o
   CC      spl/drivers/clk/rockchip/clk_rk3399.o
   LD      spl/drivers/clk/rockchip/built-in.o
   LD      spl/drivers/clk/tegra/built-in.o
   CC      spl/drivers/clk/clk-uclass.o
   CC      spl/drivers/clk/clk_fixed_rate.o
   CC      spl/drivers/clk/clk_fixed_factor.o
   LD      spl/drivers/clk/built-in.o
   CC      spl/drivers/core/device.o
   CC      spl/drivers/core/fdtaddr.o
   CC      spl/drivers/core/lists.o
   CC      spl/drivers/core/root.o
   CC      spl/drivers/core/uclass.o
   CC      spl/drivers/core/util.o
   CC      spl/drivers/core/simple-bus.o
   CC      spl/drivers/core/dump.o
   CC      spl/drivers/core/regmap.o
   CC      spl/drivers/core/syscon-uclass.o
   CC      spl/drivers/core/of_extra.o
   CC      spl/drivers/core/ofnode.o
   CC      spl/drivers/core/read_extra.o
   LD      spl/drivers/core/built-in.o
   CC      spl/drivers/firmware/firmware-uclass.o
   LD      spl/drivers/firmware/built-in.o
   LD      spl/drivers/misc/built-in.o
   CC      spl/drivers/mmc/mmc.o
   CC      spl/drivers/mmc/mmc-uclass.o
   CC      spl/drivers/mmc/dw_mmc.o
   CC      spl/drivers/mmc/rockchip_dw_mmc.o
   CC      spl/drivers/mmc/sdhci.o
   CC      spl/drivers/mmc/rockchip_sdhci.o
   LD      spl/drivers/mmc/built-in.o
   LD      spl/drivers/pinctrl/broadcom/built-in.o
   LD      spl/drivers/pinctrl/nxp/built-in.o
   CC      spl/drivers/pinctrl/rockchip/pinctrl-rockchip-core.o
   CC      spl/drivers/pinctrl/rockchip/pinctrl-rk3399.o
   LD      spl/drivers/pinctrl/rockchip/built-in.o
   CC      spl/drivers/pinctrl/pinctrl-uclass.o
   CC      spl/drivers/pinctrl/pinctrl-generic.o
   LD      spl/drivers/pinctrl/built-in.o
   CC      spl/drivers/ram/rockchip/sdram_rk3399.o
   LD      spl/drivers/ram/rockchip/built-in.o
   CC      spl/drivers/ram/ram-uclass.o
   LD      spl/drivers/ram/built-in.o
   CC      spl/drivers/serial/serial-uclass.o
   CC      spl/drivers/serial/ns16550.o
   LD      spl/drivers/serial/built-in.o
   CC      spl/drivers/sysreset/sysreset-uclass.o
   CC      spl/drivers/sysreset/sysreset_rockchip.o
   LD      spl/drivers/sysreset/built-in.o
   LD      spl/drivers/built-in.o
   LD      spl/dts/built-in.o
   CC      spl/fs/fs_internal.o
   LD      spl/fs/built-in.o
   LDS     spl/u-boot-spl.lds
   LD      spl/u-boot-spl
   OBJCOPY spl/u-boot-spl-nodtb.bin
   COPY    spl/u-boot-spl.dtb
   CAT     spl/u-boot-spl-dtb.bin
   COPY    spl/u-boot-spl.bin
   MKIMAGE u-boot.img
   COPY    u-boot.dtb
   MKIMAGE u-boot-dtb.img
   CFGCHK  u-boot.cfg

Create u-boot.itb image

::

   $ make u-boot.itb
   CHK     include/config/uboot.release
   CHK     include/generated/version_autogenerated.h
   CHK     include/generated/timestamp_autogenerated.h
   UPD     include/generated/timestamp_autogenerated.h
   CHK     include/generated/generic-asm-offsets.h
   CHK     include/generated/asm-offsets.h
   HOSTCC  tools/mkenvimage.o
   HOSTLD  tools/mkenvimage
   HOSTCC  tools/fit_image.o
   HOSTCC  tools/image-host.o
   HOSTCC  tools/dumpimage.o
   HOSTLD  tools/dumpimage
   HOSTCC  tools/mkimage.o
   HOSTLD  tools/mkimage
   CC      arch/arm/cpu/armv8/fwcall.o
   LD      arch/arm/cpu/armv8/built-in.o
   CC      cmd/version.o
   LD      cmd/built-in.o
   CC      common/main.o
   LD      common/built-in.o
   CC      lib/efi_loader/helloworld.o
   CC      lib/efi_loader/efi_reloc.o
   CC      lib/efi_loader/efi_freestanding.o
   LD      lib/efi_loader/helloworld_efi.so
   OBJCOPY lib/efi_loader/helloworld.efi
   CC      lib/smbios.o
   CC      lib/display_options.o
   LD      lib/built-in.o
   LD      u-boot
   OBJCOPY u-boot-nodtb.bin
   start=$(aarch64-linux-gnu-nm u-boot | grep __rel_dyn_start | cut -f 1 -d ' '); end=$(aarch64-linux-gnu-nm u-boot | grep __rel_dyn_end | cut -f 1 -d ' '); tools/relocate-rela u-boot-nodtb.bin 0x00200000 $start $end ./"arch/arm/mach-rockchip/make_fit_atf.py" \
   arch/arm/dts/rk3399-nanopi-m4.dtb > u-boot.its
   MKIMAGE u-boot.itb

Create image

::

   $ ./tools/mkimage -n rk3399 -T rksd -d ./spl/u-boot-spl-dtb.bin out
   Image Type:   Rockchip RK33 (SD/MMC) boot image
   Data Size:    98304 bytes

Write the images to the sdcard

::

   $ sudo dd if=out of=/dev/sdb seek=64
   196+0 records in
   196+0 records out
   100352 bytes (100 kB, 98 KiB) copied, 0.0362671 s, 2.8 MB/s

   $ sudo dd if=u-boot.itb of=/dev/sdb seek=16384
   1439+1 records in
   1439+1 records out
   737112 bytes (737 kB, 720 KiB) copied, 0.245751 s, 3.0 MB/s

   $ sync


Now insert the sdcard and power on the board

Buildroot
==========

